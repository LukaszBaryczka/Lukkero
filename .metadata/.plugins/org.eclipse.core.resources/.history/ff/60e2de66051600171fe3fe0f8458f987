package inzynierka.lukkero.controller;

import org.springframework.stereotype.Controller;
import org.springframework.web.bind.annotation.*;

import inzynierka.lukkero.model.User;

import javax.servlet.http.HttpServletRequest;
import java.math.BigInteger;
import java.util.ArrayList;
import java.util.List;

/**
 * Created by ≈Åukasz Baryczka on 24.01.2017.
 */
@Controller
@RequestMapping(value = "/inz/lukas")
public class InzynierkaController {

    List<User> users;

    @RequestMapping(value = "/home", method = RequestMethod.GET)
    public String get() {
        return "Hello world, method GET";
    }

    @RequestMapping(value = "/home", params = {"param"}, method = RequestMethod.GET)
    public @ResponseBody String getParam(@RequestParam(value = "param") String param) {
        return "Hello world, method  and param = " + param;
    }

    @RequestMapping(value = "/user", params = {"id"}, method = RequestMethod.GET)
    public @ResponseBody
    User getUser(@RequestParam(value = "id") int id) {

        users = new ArrayList<>();

        User user = new User();
        user.setEmail("l.baryczka@gmail.com");
        user.setName("Lukasz");
        user.setSurname("Baryczka");

        users.add(user);

        User user2 = new User();
        user2.setEmail("l.baryczka@gmail.com2");
        user2.setName("Lukasz2");
        user2.setSurname("Baryczka2");


        users.add(user2);

        for(User u : users) {
            if(u.getId == BigInteger.valueOf(id)) {
                return u;
            }
        }

        return new User();
    }

    @RequestMapping(value = "/users", method = RequestMethod.GET)
    public List<User> getUsers() {

        users = new ArrayList<>();

        User user = new User();
        user.email = "l.baryczka@gmail.com";
        //user.id = BigInteger.valueOf(users.size());
        user.name = "Lukasz";
        user.surname = "Baryczka";

        User user2 = new User();
        user2.email = "l.baryczka@gmail.com2";
        //user2.id = BigInteger.valueOf(users.size());
        user2.name = "Lukasz2";
        user2.surname = "Baryczka2";

        users.add(user);
        users.add(user2);

        return users;
    }

    @RequestMapping(value = "/create_user", method = RequestMethod.POST)
    public @ResponseBody String postUser(HttpServletRequest request,
                                             @RequestParam(value="name", required=false) String name,
                                             @RequestParam(value="suname", required=false) String surname,
                                             @RequestParam(value="email", required=false) String email){
        String response;
        try{
            User u = new User();
            //u.id = BigInteger.valueOf(users.size());
            u.email = email;
            u.name = name;
            u.surname = surname;
            response = "Success";
        }catch(Exception ex){
            response = "Fail";
        }
        return response;
    }
}